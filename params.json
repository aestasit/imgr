{"name":"Imgr","tagline":"","body":"# imgr \r\n\r\n## A [Packer](http://www.packer.io/) inspired tool written in Groovy\r\n\r\n_imgr_ is a tool to create Amazon EC2 AMIs (images) from a configuration file.\r\n\r\nIt is built with extensibility in mind, therefore it is easy to add new cloud providers.\r\n\r\nCurrently, it supports configuring a box via a [Puppet](http://projects.puppetlabs.com/) manifest or a Shell script.\r\n\r\n## Requirements\r\n\r\n- Java 6\r\n\r\n## Building\r\n\r\n`gradlew clean build`\r\n\r\nTests are disabled by default. To enable the tests, use\r\n\r\n`gradlew clean build -Drun.tests=true`\r\n\r\n## Installation\r\n\r\n- Run `gradlew distZip` (or `gradlew.bat distZip` on Windows )\r\n- An archive containing the application's runtime and script is generated in the 'build/distributions' folder\r\n- Unzip the archive in any location\r\n\r\n## Usage\r\n\r\n- Run `bin/groovy-packer config.json` to execute a configuration located in the `config.json` file.\r\n\r\n## Template configuration\r\n\r\n_groovy-packer_ configuration is based on a template written in in JSON. A template contains the various components\r\nrequired to build a machine image. A template has two sections:\r\n\r\n- Builder\r\n- Provisioner\r\n\r\n### Builders\r\n\r\nA _builder_ represent the description of how to start a Virtual Machine. Currently, _groovy-packer_ only supports Amazon EC2.\r\nThe Amazon builder is named `amazon-ebs` and has the following properties:\r\n\r\n- `type` (string) the type of builder. At the moment only `amazon-ebs` is supported\r\n- `access_key` (string) the access key used to communicate with AWS. If not specified,\r\nPacker will attempt to read this from the environmental variable `AWS_ACCESS_KEY_ID`\r\n- `secret_key` (string) The secret key used to communicate with AWS.\r\nIf not specified, Packer will attempt to read this from environmental variables `AWS_SECRET_ACCESS_KEY`\r\n- `region` (string) The name of the region, such as \"us-east-1\", in which to launch the EC2 instance to create the AMI.\r\n- `source_ami` (string) The AMI used to start the machine that will be configured.\r\n- `instance_type` (string) The EC2 instance type used for starting the machine. For a list of valid instance types refer to the [Amazon documentation](https://aws.amazon.com/ec2/instance-types/#instance-details).\r\n- `ssh_username` (string) The username used by _groovy-packer_ to communicate with the machine over SSH.\r\n- `ami_name` (string) The name of the generated AMI. Please note that the name must be unique.\r\n- `keypair` (string) The name of the key pair used to connect to your EC2 instance. __This option will be removed soon__\r\n- `keypair_location`  (string) The path to the key pair stored on the local machine __This option will be removed soon__\r\n- `security_group` (string) The name of the security group to use for the instance  __This option will be removed soon__\r\n\r\nThe `amazon-ebs` builder creates an instance which root device is backed by Amazon EBS (for more information about instance types read [here](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ComponentsAMIs.html#storage-for-the-root-device).\r\n\r\nHere is an example of a Builder:\r\n\r\n\t\"builders\": [{\r\n    \t\"type\": \"amazon-ebs\",\r\n        \"access_key\": \"AMAZON_1234556790\",\r\n        \"secret_key\": \"AMAZON_SECRET_12345\",\r\n        \"region\": \"eu-west-1\",\r\n        \"source_ami\": \"ami-9bf6e0ef\",\r\n        \"instance_type\": \"t1.micro\",\r\n        \"ssh_username\": \"ec2-user\",\r\n        \"ami_name\": \"groovy\",\r\n        \"keypair\": \"mykeypair\",\r\n        \"keypair_location\":\"/Users/John/.ec2/mykeypair.pem\",\r\n        \"security_group\": \"default-security\"\r\n    }]\r\n\r\n\r\n### Provisioners\r\n\r\nThe `provisioners` section of the template is an array of one or more objects that defines the provisioners that will be\r\nused to install and configure software for the machines created by each the builders.\r\n\r\nAt the moment there are two provisioners supported: a Shell provisioner and a Puppet provisioner.\r\n\r\n#### Shell provisioner\r\n\r\nA shell provisioner allows to configure a box either by sending an array of commands or a Shell script.\r\n\r\nThe configuration for a shell provisioner has 3 arguments:\r\n\r\n- `type` (string) the provisioner type, in the case of the shell provisioner the value must be `shell`.\r\n- `inline` (array of string) This is an array of commands to execute.\r\nThe commands are concatenated by newlines and turned into a single file, so they are all executed within the same context.\r\nThis allows you to change directories in one command and use something in the directory in the next and so on.\r\nInline scripts are the easiest way to pull of simple tasks within the machine.\r\n- `script` (string) The absolute path to a script to upload and execute in the machine\r\n\r\nHere is an example of a shell provisioner:\r\n\r\n    \"provisioners\": [{\r\n        \"type\": \"shell\",\r\n        \"inline\": [\"uname -a > uname.txt\",\"touch test.txt\"],\r\n        \"script\":\"/Users/john/provision/myscript.sh\"\r\n    }]\r\n\r\n#### Puppet provisioner\r\n\r\nThe Puppet provisioner installs and configures software on machines built by Packer using [Puppet](http://puppetlabs.com/puppet/puppet-open-source). A Puppet manifest is uploaded to the target machine and executed using `puppet apply`. The provisioner will even install Puppet onto your machine if it isn't already installed.\r\n\r\nAt the moment, it is possible to apply a single manifest. The configuration for the Puppet provisioner has only three fields:\r\n\r\n- `type` (string) the provisioner type, in the case of the shell provisioner the value must be `puppet-masterless`.\r\n- `manifest_file` (string) the absolute path of the Puppet manifest on the local filesystem.\r\n- `staging_directory` (string) the location on the remote machine to where the manifest is uploaded. If empty, the manifest is uploaded in the user home.\r\n\r\nHere is an example of a shell provisioner:\r\n\r\n    \"provisioners\": [{\r\n        \"type\": \"puppet-masterless\",\r\n        \"manifest_file\": \"/Users/john/puppet/site.pp\",\r\n        \"staging_directory\" : \"/tmp\"\r\n    }]\r\n\r\n## Complete configuration example\r\n\r\n    {\r\n        \"builders\": [{\r\n            \"type\": \"amazon-ebs\",\r\n            \"access_key\": \"AMAZON_1234556790\",\r\n            \"secret_key\": \"AMAZON_SECRET_12345\",\r\n            \"region\": \"eu-west-1\",\r\n            \"source_ami\": \"ami-9bf6e0ef\",\r\n            \"instance_type\": \"t1.micro\",\r\n            \"ssh_username\": \"ec2-user\",\r\n            \"ami_name\": \"groovy\",\r\n            \"keypair\": \"mykeypair\",\r\n            \"keypair_location\":\"/Users/John/.ec2/mykeypair.pem\",\r\n            \"security_group\": \"default-security\"\r\n        }],\r\n        \"provisioners\": [{\r\n            \"type\": \"puppet-masterless\",\r\n            \"manifest_file\": \"/Users/john/puppet/site.pp\",\r\n            \"staging_directory\" : \"/tmp\"\r\n        }]\r\n    }\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}