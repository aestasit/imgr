
dependencies {
  testCompile 'junit:junit:4.11'
  testCompile 'com.aestasit.infrastructure.mock:groovy-sshd-mock:0.3-SNAPSHOT'
  testRuntime 'ch.qos.logback:logback-classic:1.0.7'
}

sourceSets {
  integrationTest {
    groovy { srcDir 'src/integration-test/groovy' }
    resources { srcDir 'src/integration-test/resources' }
    compileClasspath = sourceSets.main.runtimeClasspath + sourceSets.test.runtimeClasspath 
    runtimeClasspath = output + compileClasspath
  }
}

task integrationTest(type: Test) {
  testClassesDir = sourceSets.integrationTest.output.classesDir
  classpath += sourceSets.integrationTest.runtimeClasspath
}

tasks.withType(Test) {
  doFirst {
    systemProperties = System.getProperties()
    project.properties.each { key, value ->
      if (key.startsWith("aws")) {
        systemProperties[key] = value
      }
    }
  }
}
